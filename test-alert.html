<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NWS Alert Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    pre {
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h2 {
      margin-top: 30px;
    }
    .test-button {
      background: #1976d2;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin: 10px 5px;
    }
    .test-button:hover {
      background: #1565c0;
    }
    #result {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>NWS Alert API Test</h1>

  <h2>Test Your Location</h2>
  <p>Enter your coordinates or use defaults:</p>
  <label>Latitude: <input type="text" id="lat" value="28.5383" placeholder="28.5383"></label><br><br>
  <label>Longitude: <input type="text" id="lon" value="-81.3792" placeholder="-81.3792"></label><br><br>

  <button class="test-button" onclick="testAlerts()">Fetch Real NWS Alerts</button>
  <button class="test-button" onclick="showSampleAlert()">Show Sample Alert JSON</button>

  <div id="result"></div>

  <h2>Sample Alert JSON Response</h2>
  <pre id="sample-json">{
  "type": "FeatureCollection",
  "features": [
    {
      "id": "https://api.weather.gov/alerts/urn:oid:2.49.0.1.840.0.123456789",
      "type": "Feature",
      "properties": {
        "id": "urn:oid:2.49.0.1.840.0.123456789",
        "areaDesc": "Orange County; Seminole County",
        "geocode": {
          "UGC": ["FLC095", "FLC117"],
          "SAME": ["012095", "012117"]
        },
        "sent": "2025-10-19T18:00:00-04:00",
        "effective": "2025-10-19T18:00:00-04:00",
        "onset": "2025-10-19T18:00:00-04:00",
        "expires": "2025-10-19T22:00:00-04:00",
        "ends": "2025-10-19T22:00:00-04:00",
        "status": "Actual",
        "messageType": "Alert",
        "category": "Met",
        "severity": "Severe",
        "certainty": "Likely",
        "urgency": "Immediate",
        "event": "Severe Thunderstorm Warning",
        "sender": "w-nws.webmaster@noaa.gov",
        "senderName": "NWS Melbourne FL",
        "headline": "Severe Thunderstorm Warning issued October 19 at 6:00PM EDT until October 19 at 10:00PM EDT by NWS Melbourne FL",
        "description": "At 600 PM EDT, a severe thunderstorm was located over Orlando, moving east at 25 mph. HAZARD...60 mph wind gusts and quarter size hail. SOURCE...Radar indicated. IMPACT...Hail damage to vehicles is expected. Expect wind damage to roofs, siding, and trees.",
        "instruction": "For your protection move to an interior room on the lowest floor of a building. Large hail and damaging winds and continuous cloud to ground lightning is occurring with this storm. Move indoors immediately.",
        "response": "Shelter",
        "scope": "Public"
      }
    }
  ],
  "title": "Current watches, warnings, and advisories",
  "updated": "2025-10-19T18:00:00-04:00"
}</pre>

  <script>
    async function testAlerts() {
      const lat = document.getElementById('lat').value || '28.5383';
      const lon = document.getElementById('lon').value || '-81.3792';
      const resultDiv = document.getElementById('result');

      resultDiv.innerHTML = '<p>Fetching alerts...</p>';

      try {
        const url = `https://api.weather.gov/alerts/active?point=${lat},${lon}`;
        console.log('Fetching from:', url);

        const response = await fetch(url);
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }

        const data = await response.json();

        if (data.features && data.features.length > 0) {
          resultDiv.innerHTML = `
            <h3>✅ Found ${data.features.length} Alert(s)</h3>
            <pre>${JSON.stringify(data, null, 2)}</pre>
          `;
        } else {
          resultDiv.innerHTML = `
            <h3>ℹ️ No Active Alerts</h3>
            <p>There are currently no weather alerts for this location.</p>
            <p>API Response:</p>
            <pre>${JSON.stringify(data, null, 2)}</pre>
          `;
        }
      } catch (error) {
        resultDiv.innerHTML = `
          <h3>❌ Error</h3>
          <p style="color: red;">${error.message}</p>
        `;
        console.error('Error fetching alerts:', error);
      }
    }

    function showSampleAlert() {
      const sampleJson = document.getElementById('sample-json').textContent;
      document.getElementById('result').innerHTML = `
        <h3>Sample Alert Parsed</h3>
        <p>This is what the card would receive:</p>
        <pre>${sampleJson}</pre>
      `;
    }
  </script>
</body>
</html>
